# ブランチとマージ
## ブランチとは
　分岐することで複数の機能を並行して複数機能を開発するための仕組み

### ブランチの仕組み

*ブランチはコミットIDを記録したポインタのことである*

コミットはスナップショット(*その時点の状態を丸ごと保存したもの*)である。<br>
コミットは親コミット（自分の直前のコミット）のIDを記録しており、それが時系列順に連なっている。

ブランチを作成するということは、*その時点の最新のコミットIDを指す（コミットファイル名を記録した）ポインタ*を作成するということである。

補足
ブランチを使用していると*HEAD*という単語がよく出てくる
*HEAD* は今自分が作業しているブランチを指し示すポインタのこと

## 新しいブランチの作成
### ブランチの新規作成
```
git branch <ブランチ名>
```

このコマンドはブランチを作成するだけで、*ブランチの切り替えまでは行わない*

### ブランチの一覧を表示する
```
git branch

// すべてのブランチを表示する
git branch -a
```


## ブランチの切り替え
```
git checkout <切り替え先ブランチ名>

// ブランチの新規作成と切り替えを一度に行う
git checkout -b <新ブランチ名>
```

## マージとは
他の人の変更を取り込む作業のこと
```
// ローカルブランチの内容を自分の作業中のブランチにマージする
git merge <margeするブランチ名>

// リモートブランチの内容を自分の作業中のブランチにマージする
git merge <リモート名>/<mergeするブランチ名>
git merge origin/main
```

###  Fast Foward
ブランチが枝分かれしていない場合、取り込み先のブランチに取り込み元のブランチのポインタを進めるだけ<br>
新しいコミットは作成されない

### Auto Merge
ブランチが枝分かれしている場合は、マージコミットという新しいコミットファイル（取り込み元のコミットファイルの内容をベースに、取り込み先のコミットファイルの変更分を取り込んみ、スナップショットとして記録している）が作成され、そこに取り込み元のポインタが移動する。<br>
親コミットを二つ持っている

補足：リモートブランチとは
*リモートのブランチの状態へのポインタ*のこと
git fetch でリモートリポジトリの内容を取得すると<br>
リモートリポジトリのコミットファイルをローカルにも保存し
ブランチに関してはorigin/ブランチ名という形でブランチを作成して
保存したコミットファイルのポインタとして機能させている

## コンフリクトの解決
同じファイルの同じ行に対して異なる編集をおこなったブランチをmerge使用とすると、どちらの変更を優先するか判断ができないため、コンフリクトが発生する
```
<h1>Gtiチュートリアル</h1>
<p>ここから下がコンフリクトしている</p>
<<<<<<< HEAD
<p>HEADの変更分</p>
=======
<p>取り込み先の変更分</p>
>>>>>>> 取り込み先ブランチ名
```

コンフリクトを解消するためには
1. ファイルの内容を書き換える
2. 「<<」「==」「>>」の記述を削除する

コンフリクトを起こさないためには
* 複数人で同じファイルを変更しない
* pullやmergeする前に変更中の状態を無くしておく(commitやstashをしておく)
* pullするときはpullするブランチに移動してからpullする


## ブランチ名の変更・削除
```
// ブランチ名の変更
git branch -m <新ブランチ名>

// ブランチ名の削除(mainにマージされていない変更がある場合は削除しない)
git branch -b <ブランチ名>

// 強制削除する
git branch -D <ブランチ名>
```


## ブランチを利用した開発の流れ
mainブランチをリリース用ブランチに<br>
開発は、最新のmainブランチから、トピックごとにブランチを作成して進める

